Here is a commented version the config.json file

```json
{
   "servers" : [ {
      "host" : "localhost",
      "port" : "9999",
      "queries" : [ {
         "outputWriters" : [ {
            "@class" : "com.googlecode.jmxtrans.model.output.kafka.KafkaWriter",
            "booleanAsNumber" : false,
            "rootPrefix" : "myPrefix",
            "debug" : true,
            "formatter": "com.googlecode.jmxtrans.model.output.kafka.DefaultMessageFormatter",
            "tags" : {
            } ,
            "settings" : {
               "bootstrap.servers": "kafkaBrokerHost:9092",
               "topics" : "myTopic"
            }
         } ],
         "obj" : "java.lang:type=Memory,*",
         "attr" : [ "HeapMemoryUsage" ]
      } ]
   } ]
}
```

## formatter

Formatter is the name of the class used to format message. You can override it by implements the KafkaMessageFormatter Interface.


### DefaultMessageFormatter

When no formmater is specified, then the DefaultMessageFormatter will be used.
The above file with generate kafka messages written to the kafka topic
"myTopic". The HeapMemoryUsage metric has 4 parts to it (init,
commited, max, and used) and so 4 messages will be written to the
topic that look like:

```
{"keyspace":"myPrefix.localhost_9999.sun_management_MemoryImpl.HeapMemoryUsage_init","value":"536870912","timestamp":1462947750,"tags":{}}
{"keyspace":"myPrefix.localhost_9999.sun_management_MemoryImpl.HeapMemoryUsage_committed","value":"536870912","timestamp":1462947750,"tags":{}}
{"keyspace":"myPrefix.localhost_9999.sun_management_MemoryImpl.HeapMemoryUsage_max","value":"536870912","timestamp":1462947750,"tags":{}}
{"keyspace":"myPrefix.localhost_9999.sun_management_MemoryImpl.HeapMemoryUsage_used","value":"22020096","timestamp":1462947750,"tags":{}}
```

FYI, the keyspace is a period-delimited string that consists of the
following parts:

1. rootPrefix
2. hostname_port
3. classname of the MBean
4. value of the field specified in "typeNames"


### MetricsMessageFormatter

When the metrics formatted is set, then all results will be be aggregated to build a metrics 2.0 like message :
**What** is the TypeName parsed to only fetch the type of the MBean (not the name).
If name is defined in the TypeName, the **device** field will be equal to that name.
Then, for each result the **metrics name** is equal to AttributeName +"_" +results.getKey()
if Attribute Name and results key are different, else the result key is used.

Here is the Kafka message generated by the MetricsMessage formatter with the above config (pretty printed) :
```json
{
  "host":"localhost",
  "what":"Memory",
  "device":"",
  "timestamp":1462947750,
  "HeapMemoryUsage_init":536870912,
  "HeapMemoryUsage_committed":536870912,
  "HeapMemoryUsage_max":536870912,
  "HeapMemoryUsage_used":22020096,
  "meta":{
    "issuer":"jmxtrans"
  }
}
```

## Settings
Settings is used to configure the org.apache.kafka.clients.producer.KafkaProducer Output.
All parameters from the https://kafka.apache.org/documentation.html#producerconfigs can be used.
These are the default properties :
 * "acks" : "all"
 * "retries" : 0
 * "batch.size" : 16384
 * "linger.ms" : 1
 * "buffer.memory" : 33554432
 * "key.serializer" : "org.apache.kafka.common.serialization.StringSerializer"
 * "value.serializer" : "org.apache.kafka.common.serialization.StringSerializer"

